# SAM3D Testing Report (WSL)

*Single-image to 3D Reconstruction Testing -- February 1, 2026 | Environment: WSL (Ubuntu on Windows)*

## Environment Information

| Item | Value |
|------|-------|
| GPU | RTX 5080 |
| VRAM | 16 GB |
| PyTorch | 2.11 dev |
| CUDA | 12.8 |

## Test Summary

| Test | Input Resolution | Stage 1 | Stage 2 | Stage 3 | Result |
|------|-----------------|---------|---------|---------|--------|
| Original Demo | 4480x6720 | Pass | Pass | OOM | **Failed** |
| Stage 1 Standalone Test | 4480x6720 | Pass | - | - | **Partial** |
| 1080p Scaled | 1920x1080 | Pass | Pass | OOM | **Failed** |

## Detailed Test Process

### Step 1: Environment Setup

Created conda environment `sam3d-objects`, installed PyTorch 2.11 dev + CUDA 12.8. Recompiled CUDA extensions including spconv, nvdiffrast, kaolin, etc. Downloaded model weights from HuggingFace (~13GB).

### Step 2: Original Demo Test (4480x6720) -- FAILED

```
Stage 1 (Sparse Structure): Pass - Generated 29704 -> 29069 points
Stage 2 (SLAT): Pass - Completed in ~3 minutes
Stage 3 (Decode): Fail - OutOfMemoryError

torch.OutOfMemoryError: CUDA out of memory.
Tried to allocate 1.51 GiB. GPU 0 has 16.00 GiB total.
```

### Step 3: Stage 1 Standalone Test -- PARTIAL

Created `demo_stage1.py` to run only Stage 1 for point cloud generation. Successfully generated voxel coordinates and saved to `stage1_voxel.npy` (316KB), containing approximately 29000 3D points.

### Step 4: Skip Pointmap Attempt -- FAILED

Attempted to bypass MoGe depth estimation to save VRAM. Problem: The SAM3D pipeline has a strong dependency on pointmap; the API design does not support skipping it.

### Step 5: 1080p Scaled Test -- FAILED

```
Stage 1: Pass - 29069 points (~20 seconds)
Stage 2: Pass - SLAT sampling completed (~3 minutes)
Stage 3: Fail - Killed by SIGKILL during decode

dmesg shows:
dxgk: dxgkio_make_resident: Ioctl failed: -12 (insufficient VRAM)
```

## VRAM Analysis

### VRAM Bottleneck

SAM3D's VRAM consumption mainly comes from:

| Component | VRAM Usage | Description |
|-----------|-----------|-------------|
| Model Loading | ~10GB | ss_generator + slat_generator (DiT), 4x DINO ViT-L, MoGe, Decoders |
| Inference Process | ~6GB+ | Pointmap embedding, Diffusion sampling (25 steps x 2), Decode |
| **Total** | **~20GB+** | **16GB VRAM is insufficient** |

## Possible Solutions

| Solution | Difficulty | Effectiveness |
|----------|-----------|---------------|
| Further reduce resolution (720p/512p) | Easy | May work, but quality decreases |
| Only generate Gaussian (skip mesh) | Medium | Saves some VRAM |
| Model quantization (8-bit) | Medium | Requires modifying loading code |
| CPU offloading | Hard | Very slow |
| Use 24GB+ GPU | Easy | Directly solves the problem |

## Generated Files

```
utils/third_party/sam3d/
├── stage1_voxel.npy     # Stage 1 output point cloud coordinates (316KB)
├── demo_stage1.py       # Stage 1 standalone test script
├── demo_1080p.py        # 1080p scaled test script
└── demo_minimal.py      # Minimal test script
```

## Machine Resource Usage

CPU/GPU/Memory usage during SAM3D inference:

### Memory Usage

![Memory Usage](test_results_images/Image_20260130200053_8_44.png)

- System memory: 26.4/31.1 GB (85%)
- GPU 1 (RTX 5080): 98% utilization
- DDR5-4800 MT/s

### GPU Usage

![GPU Usage](test_results_images/Image_20260130200057_9_44.png)

- 3D utilization: 100%
- VRAM: 16 GB (completely full)
- Driver: 32.0.15.9174

### Resource Bottleneck Analysis

- **GPU VRAM**: 16GB completely full -- the direct cause of OOM
- **System memory**: 85% usage, approaching the limit
- **GPU utilization**: 100% full load, model is compute-intensive

---

*Generated by Arin | Updated by Yuna | SAM3D Testing Report*
*Environment: WSL (Ubuntu on Windows) | RTX 5080 (sm_120) | CUDA 12.8 | PyTorch 2.11 dev*
*Date: February 1, 2026 | Updated: February 3, 2026*
